# D3M-PIN
D3M-PIN is the abbreviation of Distributed Multiparty Mobile Mixin PIN. Simply put, it is a distributed multi-party mobile hybrid PIN technology. Different from the simple centralized 6-digit password that is common in traditional centralized applications, D3M-PIN is a distributed password solution that is jointly guaranteed by participants from different parties

The main participants in D3M-PIN include the user (U), trusted registrar (M), and trusted distributed ledger (L). The three D3M-PIN participants cooperate to achieve sufficient decentralization, security, and credibility while ensuring that the user experience is the simplest.

User (U) refers to a specific user of Mixin Messenger. It may be a real person or a bot, and they are not associated with a specific device. The user’s responsibility is to remember his 6-digit PIN , which is simple and convenient enough. This PIN is part of the overall private key scheme.

A trusted registrar (M) refers to a service provider that provides SMS verification codes. One example is a server maintained by Mixin Messenger. The main responsibility of the registrar is to help users synchronize another part of the private key scheme.

Distributed ledger (L) is a distributed ledger network that uses open and trusted computing. The most obvious one is the PoS consensus BFT-DAG network provided by Mixin Network.

### D3M-PIN Computation Process
Every user who uses Mixin Messenger will have a mainnet multi-signature private key on Mixin Kernel. For the convenience of explanation, we have the following assumptions and conventions:

- The number of nodes in L is n, and we assume that U's multi-signature private key also needs exactly these n nodes to complete, and these n nodes are fixed and unchanged.

- 1...n represents the relevant parameters of the 1st to the nth node in turn, for example, L7 represents the unique public key of the main network of the 7th node, and l7 represents the corresponding private key of *L7.

- PIN is a 6-digit password picked by the user, and the 6-digit password is fixed and unchanged.

- Hs is a cryptographic hash algorithm, which can always generate the same result deterministically for the same input, and there is no conflict.

- I is a standard UUID randomly generated by M to represent a piece of unique account information.

- m is a key kept privately by M, which does not change with M's life cycle.

- Fs(a,X) is the standard EdDSA signature algorithm, which represents the use of the private key a to sign the message X.

- If a represents an EdDSA private key, then aG represents the corresponding public key.

With the above definition, let’s see how a user can safely use a phone number and a 6-digit PIN to complete a transaction:

1. When U log in Mixin Messenger for the first time on a device,  account information I can be associated with U through M's SMS verification code service.
2. M will generate n one-to-one corresponding verification seeds through si = Hs(I || m || Li) for each node in L.
3. For each newly generated seed si, M needs to send a unique Mixin Kernel transaction Ti to the corresponding siG.
4. M returns all n verification seeds from s1 to sn and the corresponding Ti to the current device and saves them on the device. U can choose to back up all si.
5. If it is the first time for U to register an account, he needs to use si to sign the corresponding Ti to verify the uniqueness of si to your account on the mainnet.
6. For each node in L, U generates n certain one-to-one private keys ui = Hs(PIN || si || Li).
7. For each private key ui, U generates a signature Si = Fs(ui,Hs(Li || "COMMIT")), and sends Si and the corresponding public key uiG to each node Li.
8. After verifying the correctness of Si, node Li returns an error code or returns the corresponding new public key piG to U, where pi = Hs(uiG || li).
9. After U has collected enough n new public keys, he can get his complete multi-signature public key on the mainnet P = p1G + p2G +… + pnG.
10. When he needs to use one of its own UTXOs, firstly he will generate the corresponding transaction T, then sign Si = Fs(ui,Hs(Li || Hs(T))), and send Si and uiG to each node Li .
11. After verifying the correctness of Si, node Li returns an error code or returns a corresponding new signature Si = Fs(Hs(uiG || li),Hs(T)) to U.
12. After U has collected enough n new signatures, the complete multi-signature S = S1 + S2 +… + Sn of transaction T can be obtained.
The most critical point in this process is that node Li has a strict limit on the number of requests for verification of each signature request.

### The Security Proof of D3M-PIN

We will analyze and prove the possible risks in the overall process of D3M-PIN to show that this solution is safe, reliable and completely decentralized. Since the user U and the distributed ledger L are already a secure decentralized solution, the following analysis is only for the possible problems of the registrar M.

- Since M may only have one operator, if he no longer operates, will the user's assets still be safe?

  It is safe. First, the registrar usually allows users to download data when they are no longer operating. At this time, users have enough time to save their private key seed si; secondly and most importantly, after the user obtains the si, he holds a  copy on the device, even if M is closed, it will not affect the use of si; finally, the user can back up all si at any time, so that regardless of whether M is closed or not, the user no longer needs to use the SMS verification code to trade at any time or switch devices.

- If the phone number is lost, how can users access their assets?

  Firstly, M provides emergency contact services. After any user loses phone number access, he can obtain his own private key seed si through the emergency contact. Secondly, people can go to the telecom operator, authenticate their identity to obtain access to their phone number again. Finally, according to the analysis in question 1, the user device has a copy of si, so that regardless of whether there is phone number access permission, users no longer need to use SMS verification codes to trade or switch devices.

- If someone else gets access to the user's phone number, are the assets still safe?

  After the attacker obtains access to the phone number, he gets the user's private key seed si. We assume that the attacker is the registrar M, which has the private key seeds of all users. Because M does not know the user's PIN, and the PIN has a total of 1 million possibilities due to the 6-digit design. Assuming a total of 30 nodes, each node has a fixed limit of 5 trial and error signature verification times per day, so the time required for M to brute force 1 million possibilities is at least 1000000/30/5/365 = 18 years. Therefore, even if M itself acts as an attacker, it is extremely difficult to steal user assets. If the use of the signature random counter is increased, the probability of being cracked will immediately become zero.

  In summary, in any case, the user's assets will be safe and accessible.
